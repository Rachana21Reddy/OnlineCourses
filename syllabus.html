<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Add Syllabus</title>
	<link rel="stylesheet" type="text/css" href="syllabus.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
	<script type="text/javascript">
    	var syllabus = [];
    	var counter = 1;
		var status = 0;
		
		function generateForm()
		{
			var syllabusForm = `<div class="sectionSyllabus">
									<label id="syllabusNumber" class="p-3 bg-primary text-white">Syllabus ${counter}</label><br>
									<input type="text" name="syllabusTitle" id="syllabusTitle" placeholder="Syllabus-Title"><br><br>
									<input name="description" id="description" placeholder="Syllabus-Description"></input><br><br>
									<input type="text" name="objective" id="objective" placeholder="Learning Objectives"><br><br>
									<button id="save" class="btn btn-primary" title="Save" onclick="save()"> Save</button>
									<button id="cancel" class="btn btn-primary" title="Cancel">Cancel</button>
									<br><br>
								</div>`;
			counter++;
			addSyllabus(syllabusForm)

		}

		function addSyllabus(syllabusForm)
		{
			$("#syllabusBtn").prop('disabled', true);
			$("#syllabus").append(syllabusForm);
		}

		$(document).on('click', '#cancel', function() {
		    $(this).parent().remove();
		    $("#syllabusBtn").prop('disabled', false);
	    });

		function save(index) {
			$(".sectionSyllabus").hide();
			var syllabusData = {};
				$('.sectionSyllabus input').each(function() {
					var id = $(this).attr("id");
					var value = $(this).val();
				    if (value != '') {
				        syllabusData[id] = value;
				    }
				})
			if(status == 0) {
				syllabus.push(syllabusData);
				console.log(syllabus);
				renderCards();
				$(this).parent().hide();
			}
			else {
				syllabus[index]=syllabusData;
				renderCards();
				$(this).parent().hide();
			}
			status = 0;
		}

		function renderCards()
		{
			$(".card").remove();
			for(let iterator = 0; iterator < syllabus.length; iterator++)
			{
				let obj = syllabus[iterator];
				var cardData = `<div class="card" id="card">
		    					<div class="index rounded-circle">${iterator + 1}</div>
		    					<div class="minimizedcard">
		    						<label><b>${obj.syllabusTitle}</b></label><br>
		    						<label>${obj.description}</label>
		    						<a href="#" id="delete" onclick="deleteSyllabus(${iterator})"><span class='glyphicon glyphicon-trash'></span></a>
		    						<a href="#" id="editSyllabus" onclick="getExistingSyllabusForm(${iterator})"><span class='glyphicon glyphicon-edit'></span></a>
		    					</div>
		    				</div>`;
		    	displayCard(cardData)
		    }
		}

		function displayCard(cardData)
		{
		    $('#syllabus').append(cardData);	
			$("#syllabusBtn").prop('disabled', false);
		}

		function deleteSyllabus(index)
		{
			var ok = confirm("Are you sure you want to delete?");
			if(ok)
			{
				syllabus.splice(index, 1);
				renderCards();
			}
		}

		function getExistingSyllabusForm(index)
		{
			let obj = syllabus[index];
			var syllabusForm = `<div class="sectionSyllabus">
									<label id="syllabusNumber" class="p-3 bg-primary text-white">Syllabus ${index + 1}</label><br>
									<input type="text" name="syllabusTitle" id="syllabusTitle" placeholder="Syllabus-Title" value="${obj.syllabusTitle}"><br><br>
									<input name="description" id="description" placeholder="Syllabus-Description" value="${obj.description}"></input><br><br>
									<input type="text" name="objective" id="objective" placeholder="Learning Objectives" value="${obj.objective}"><br><br>
									<button id="save" class="btn btn-primary" title="Save" onclick="save(${index})"> Save</button>
									<button id="cancel" class="btn btn-primary" title="Cancel">Cancel</button>
									<br><br>
								</div>`;
			editSyllabus(syllabusForm)
		}

		function editSyllabus(syllabusForm) {
			$("#card").replaceWith(syllabusForm);
			status = 1;
		}

	</script>
</head>
<body id="body">
	<input type="button" name="syllabusBtn" id="syllabusBtn" value="Add Syllabus" onclick="generateForm()" class="btn btn-primary"><br>
	<div id="syllabus"></div>
</body>
</html>